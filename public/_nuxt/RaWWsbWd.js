import{j as v,cY as S,c as d,r as P,k as c,aj as m}from"./016mahUR.js";import{u as p}from"./Bd6NytqX.js";const I=v("authStore",()=>{const{toast:o}=p(),i=S(),r=d(()=>{var e;return(e=i.value)==null?void 0:e.roles[0]}),f=d(()=>r.value==="super administrador"),g=d(()=>{var e;return(e=i.value)==null?void 0:e.image}),u=P({step:"reset-password",username:"",areaCode:"+52",isPhone:!1,isFetching:!1,code:"",token:""});return{role:r,isSuperAdmin:f,user:i,image:g,forgotPasswordState:u,updateUser:e=>{c()(`api/v1/admin/profile/${e.id}`,{method:"PUT",body:e}).then(async()=>{const{refreshIdentity:t}=m();await t(),o("success","Perfil Actualizado","Tu perfil se ha actualizado exitosamente.")})},updateImage:async e=>{var s;const n=c(),t=new FormData;t.append("image",e),n(`api/v1/admin/profile/${(s=i.value)==null?void 0:s.id}/image`,{method:"POST",body:t}).then(async()=>{const{refreshIdentity:a}=m();await a(),o("success","Imagen actualizada","Tu imagen se ha actualizado exitosamente.")}).catch(a=>{var l;const h=((l=a==null?void 0:a.data)==null?void 0:l.message)||"No se pudo actualizar tu imagen. Verifica tu información e inténtalo de nuevo.";o("error","Error al actualizar tu imagen",h)})},updatePassword:e=>{c()(`api/v1/admin/profile/${e.id}/password`,{method:"PUT",body:{...e}}).then(()=>{o("success","Contraseña actualizada","Tu contraseña se ha actualizado exitosamente.")}).catch(t=>{var a;const s=((a=t==null?void 0:t.data)==null?void 0:a.message)||"No se pudo actualizar la contraseña. Verifica tu información e inténtalo de nuevo.";o("error","Error al Actualizar Contraseña",s)})},reSendCode:(e,n)=>{c()(`api/v1/verify-code/resend?${n}=${e}`).then(()=>{p().toast("success","Código reenviado","Tu código de verificación ha sido reenviado exitosamente.")}).catch(s=>{var a;o("error","Error al reenviar el código",((a=s==null?void 0:s.data)==null?void 0:a.message)??"Ha ocurrido un error al intentar reenviar tu código de verificación. Por favor, intenta nuevamente más tarde.")})},resetForgotPasswordState:()=>{u.value={step:"reset-password",username:"",areaCode:"+52",isPhone:!1,isFetching:!1,code:""}}}},{persist:{pick:["user","role","isSuperAdmin","image"]}});export{I as u};
