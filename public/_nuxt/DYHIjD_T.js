import{j as D,r as b,J as A,k,l as F,a6 as q,ae as G,c as z,w,b$ as P,x as u,q as s,i,aR as R,a as r,v as m,o as v,a8 as C,ak as E,f as l,A as S,B as y,cE as H,z as J}from"./016mahUR.js";import L from"./DK4Md9xt.js";import{b as T}from"./0QfyqDfL.js";import{s as U}from"./x_rD_Ya3.js";import{V as X}from"./jgFPC-YH.js";import{V as Z}from"./CBwUDPAE.js";import{V as x}from"./BuMHRPYM.js";const ce=D("categoryStore",()=>{const p=b([]),f=b([]),d=async()=>{const c=k();p.value=await c("/api/v1/admin/categories")},e=async()=>{const c=k();f.value=await c("/api/v1/admin/tournaments/formats")};return A(async()=>{await d(),await e()}),{categories:p,formats:f,fetchFormats:e,fetchCategories:d}}),K={key:0,class:"d-flex justify-center align-center flex-column"},O={key:1,class:"d-flex justify-space-between align-start h-100 w-100 flex-column"},Q={class:"d-flex justify-space-between w-100 align-center"},W={class:"text-body-1"},Y={key:0,class:"d-flex w-100 justify-center align-center"},ee={class:"ml-2 text-caption"},ae={key:1,class:"w-100"},re={class:"text-caption"},ue=F({__name:"drag-drop-image",props:{modelValue:{default:null},modelModifiers:{}},emits:["update:modelValue"],setup(p,{expose:f}){const d=q(p,"modelValue"),e=G({dragging:!1,dropped:!1,interval:1,value:10,bufferValue:20,image:{file:d.value,name:"",size:0,hasError:!1,errors:{name:null,description:null,action:null}}}),c=b(),B=z(()=>e.image.hasError?"":`primary ${e.dragging||e.dropped?"sm opacity-100":"thin"}`),I=z(()=>{const t=e.image.name.replace(/[-_]/g," "),a=t.charAt(0).toUpperCase()+t.slice(1);return a.length>20?`${a.substring(0,20)}...`:a}),M=()=>{const t=Number((e.image.size/1048576).toFixed(2));t>T&&(e.image.errors={name:`${t}MB`,description:"La imagen es muy pesada, prueba con otra.",action:"reintentar"},e.image.hasError=!0)},h=t=>{var o;t.preventDefault(),e.dragging=!1;let a=[];if(t.type==="drop"){const n=t;a=(o=n==null?void 0:n.dataTransfer)==null?void 0:o.files}else t.type==="change"&&(a=t.target.files);a.length&&(N(),e.dropped=!0,d.value=a[0],e.image.name=a[0].name,e.image.size=a[0].size)},N=()=>{const t=a=>Math.min(a+Math.random()*10,100);e.interval=U(()=>{if(e.image.hasError){clearInterval(e.interval);return}e.value=t(e.value),e.bufferValue=t(e.bufferValue)},100)},V=()=>{e.image.name="",e.image.size=0,e.image.hasError=!1,e.image.errors={name:"",description:"",action:""},e.dragging=!1,e.dropped=!1,e.value=10,e.bufferValue=20,d.value=null},$=()=>{e.value=100,e.bufferValue=100,e.dropped=!0,e.image.name="imagen.jpg"};w(()=>e.value,t=>{t>=100&&clearInterval(e.interval)}),w(()=>e.image.size,()=>{M()}),P(()=>{clearInterval(e.interval)});const j=()=>{var a,o;((o=(a=c.value)==null?void 0:a.$el)==null?void 0:o.querySelector("input")).click()};return f({loadImage:$}),(t,a)=>{const o=L;return s(),u("div",{class:J(["d-flex",r(e).image.hasError?" border-error border-md border-opacity-100  rounded rounded-lg":""])},[i(R,{color:r(e).dropped?"surface":"background",size:"64",class:"mr-2"},{default:m(()=>[r(e).dropped?C("",!0):(s(),v(o,{key:0,name:"futzo-icon:image-plus",class:"image-plus"})),r(e).dropped?(s(),v(o,{key:1,name:"futzo-icon:file-type-img",class:"file-type-img"})):C("",!0)]),_:1},8,["color"]),i(X,{border:r(B),width:"100%",class:"d-flex flex-column align-center rounded-lg pa-2",onDragover:a[1]||(a[1]=E(()=>{},["prevent"])),onDrop:[E(h,["prevent"]),a[3]||(a[3]=n=>r(e).dragging=!1)],onDragenter:a[2]||(a[2]=n=>r(e).dragging=!0)},{default:m(()=>{var n,_;return[r(e).dropped?(s(),u("div",O,[l("div",Q,[l("p",W,y(r(e).image.hasError?(n=r(e).image.errors)==null?void 0:n.name:r(I)),1),i(x,{icon:!0,size:"default",slim:"",flat:"",density:"compact",color:"background",onClick:V},{default:m(()=>[r(e).image.hasError?(s(),v(o,{key:1,name:"futzo-icon:trash-error",class:"trash-error"})):(s(),v(o,{key:0,name:"futzo-icon:trash",class:"trash"}))]),_:1})]),r(e).image.hasError?(s(),u("div",ae,[l("p",re,y((_=r(e).image.errors)==null?void 0:_.description),1),i(x,{onClick:V,density:"compact",class:"pa-0 text-capitalize",variant:"text"},{default:m(()=>{var g;return[S(y((g=r(e).image.errors)==null?void 0:g.action),1)]}),_:1})])):(s(),u("div",Y,[i(H,{modelValue:r(e).value,"onUpdate:modelValue":a[0]||(a[0]=g=>r(e).value=g),"buffer-value":r(e).bufferValue,color:"primary",rounded:"",max:"100"},null,8,["modelValue","buffer-value"]),l("span",ee,y(r(e).value.toFixed(0))+"%",1)]))])):(s(),u("div",K,[l("div",null,[i(Z,{hidden:!0,class:"d-none",ref_key:"inputRef",ref:c,onChange:h},null,512),i(x,{variant:"text",color:"primary",class:"text-body-1 px-1",onClick:j},{default:m(()=>a[4]||(a[4]=[S("Haz clic para añadir ")])),_:1,__:[4]}),a[5]||(a[5]=l("span",{class:"text-body-1"},"o arrastra aquí",-1))]),a[6]||(a[6]=l("p",{class:"text-caption"},"SVG, PNG o JPG (max. 1080x1080px)",-1))]))]}),_:1},8,["border"])],2)}}});export{ue as _,ce as u};
