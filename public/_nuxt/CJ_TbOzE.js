import{_ as B}from"./D9Gpvmdj.js";import w from"./DK4Md9xt.js";import{u as q}from"./RaWWsbWd.js";import{l as k,r as j,H as T,c as p,o as V,V as z,v as s,q as g,i as a,C as x,f as n,A as l,B as d,a as i,af as O,D as S,t as N,ag as I,a9 as P,an as A,x as D,ao as E,I as $,k as H}from"./016mahUR.js";import{u as L}from"./Bd6NytqX.js";import{V as M}from"./Cd5N-omf.js";import{V as b}from"./BuMHRPYM.js";const U={class:"icon-container"},G={class:"font-weight-bold text-black"},W={class:"w-75 mx-auto"},F={class:"verify-card-options-container"},J={class:"verify-card-didnt-get-email"},K=k({__name:"otp-card",setup(v){const t=j(""),c=T().query,o=p(()=>({type:Object.keys(c)[0],value:Object.values(c)[0]})),_=()=>{const{type:u,value:e}=o.value;e&&q().reSendCode(u==="phone"?`+${e.toString().trim()}`:e.toString().trim(),u)},f=p(()=>o.value.type==="email"?"Verificar correo":"Verificar teléfono"),C=p(()=>o.value.type==="email"?"Te enviamos un correo de verificación al":"Mensaje de WhatsApp enviado para verificar tu"),m=p(()=>o.value.type==="email"?"correo":"teléfono");return(u,e)=>{const y=w;return g(),V(z,{width:"100%","max-width":"540","max-height":"550",class:"verify-card"},{default:s(()=>[a(S,{class:"d-flex justify-center align-center"},{default:s(()=>[a(x,{class:"d-flex justify-center align-center"},{default:s(()=>[n("div",U,[a(y,{name:"futzo-icon:inbox-02",class:"mx-auto envelop-icon",size:"32"})])]),_:1}),a(x,{class:"text-center verify-card-title"},{default:s(()=>[l(d(i(f)),1)]),_:1}),a(O,{class:"text-center verify-card-subtitle"},{default:s(()=>[l(d(i(C))+" ",1),e[3]||(e[3]=n("br",null,null,-1)),l(" "+d(i(m))+": ",1),n("strong",G,d(i(o).value),1),e[4]||(e[4]=l(". "))]),_:1,__:[3,4]})]),_:1}),a(I,null,{default:s(()=>[n("div",W,[a(M,{modelValue:i(t),"onUpdate:modelValue":e[0]||(e[0]=r=>N(t)?t.value=r:null),placeholder:"0",length:"4",width:"356px","min-height":"80px"},null,8,["modelValue"]),a(b,{class:"my-5",rounded:"lg",disabled:i(t).length<4,size:"large",block:"",onClick:e[1]||(e[1]=r=>u.$emit("event",{action:"verificar",code:i(t)}))},{default:s(()=>[l("Verificar "+d(i(m)),1)]),_:1},8,["disabled"]),n("div",F,[n("p",J,"¿No recibiste el "+d(i(m)??"mensaje")+"?",1),a(b,{variant:"text",class:"mx-0 px-0",onClick:_},{default:s(()=>e[5]||(e[5]=[l("Reenviar ")])),_:1,__:[5]})]),n("div",{class:"d-flex justify-center align-center my-5 cursor-pointer",onClick:e[2]||(e[2]=r=>u.$router.push("/login"))},[a(y,{name:"futzo-icon:arrow-left",class:"arrow-left mx-1"}),e[6]||(e[6]=n("p",{class:"text-body-1 font-weight-bold"},"Regresar a registrarme",-1))])])]),_:1})]),_:1})}}}),Q={},X={class:"icon-container"},Y={class:"w-75 mx-auto my-5"};function Z(v,t){const c=w;return g(),V(z,{width:"100%","max-width":"540","max-height":"550",class:"verify-card"},{default:s(()=>[t[6]||(t[6]=n("div",{class:"d-flex justify-center align-center"},null,-1)),a(S,{class:"d-flex justify-center align-center"},{default:s(()=>[a(x,{class:"d-flex justify-center align-center"},{default:s(()=>[n("div",X,[a(c,{name:"futzo-icon:check-circle",class:"mx-auto envelop-icon",size:"32"})])]),_:1}),a(x,{class:"text-center verify-card-title"},{default:s(()=>t[2]||(t[2]=[l(" Correo verificado ")])),_:1,__:[2]}),a(O,{class:"text-center verify-card-subtitle"},{default:s(()=>t[3]||(t[3]=[l(" Gracias por confirmar tu correo, ahora puedes "),n("br",null,null,-1),l(" iniciar sesión con tu correo y contraseña. ")])),_:1,__:[3]})]),_:1}),a(I,{class:"my-5"},{default:s(()=>[n("div",Y,[a(b,{class:"my-5",rounded:"lg",size:"large",block:"",onClick:t[0]||(t[0]=o=>v.$emit("event",{action:"email-verified"}))},{default:s(()=>t[4]||(t[4]=[l(" Iniciar sesión ")])),_:1,__:[4]}),n("div",{class:"d-flex justify-center align-center my-5 cursor-pointer",onClick:t[1]||(t[1]=o=>v.$router.push("/login"))},[a(c,{name:"futzo-icon:arrow-left",class:"arrow-left mx-1"}),t[5]||(t[5]=n("p",{class:"text-body-1 font-weight-bold"},"Regresar",-1))])])]),_:1})]),_:1,__:[6]})}const ee=P(Q,[["render",Z]]),te={class:"verify-email-main-container"},ae={class:"verify-email-container"},ue=k({__name:"verificar",setup(v){const{toast:t}=L(),c=T().query,o=p(()=>({type:Object.keys(c)[0],value:Object.values(c)[0]})),_=j("OtpCard");let f=null;const C=e=>{H()("/verify",{method:"POST",body:{code:e,[o.value.type]:o.value.value}}).then(()=>{t("success","Cuenta Verificada","Tu cuenta ha sido verificado exitosamente."),_.value="VerifiedCard"}).catch(r=>{var h;const R=((h=r==null?void 0:r.data)==null?void 0:h.message)??"La verificación de tu cuenta ha fallado. Por favor, vuelve a intentarlo.";r.response.status===401?(t("info","Redirigiendo...","Por favor, espera mientras te llevamos a la siguiente página."),f=setTimeout(()=>{$().push({name:"login",params:{username:o.value.value}})},3e3)):t("error","Cuenta No Verificada",R)})};A(()=>{f&&clearTimeout(f)});const m={OtpCard:K,VerifiedCard:ee},u=e=>{e.action==="verificar"&&C(e==null?void 0:e.code),e.action==="email-verified"&&$().push(`/login?username=${o.value.value}`)};return(e,y)=>{const r=B;return g(),D("div",te,[a(r,{width:"200",class:"mx-auto"}),n("div",ae,[(g(),V(E(m[i(_)]),{type:i(o).type,onEvent:u},null,40,["type"]))])])}}});export{ue as default};
