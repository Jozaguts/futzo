import{_ as ne}from"./Bvuqmvdj.js";import{_ as ie}from"./T7PgQhTK.js";import{_ as re}from"./ULYP_ZNe.js";import{_ as de}from"./DqJEwsBV.js";import Z from"./DK4Md9xt.js";import{l as U,a5 as ue,r as $,s as I,G as me,c as D,a6 as K,o as k,q as g,a$ as N,v as a,f as x,i as t,a3 as J,a as l,t as z,a_ as te,J as ae,a7 as ce,m as H,B as w,bw as Q,A as R,x as T,a8 as B,Z as pe,a1 as fe,y as O,a2 as _e,ak as ve,a4 as be,z as X,$ as ge,dq as Ve,F as E,w as le,bH as se,V as ye,C as xe,af as Se,ag as ke,k as he}from"./016mahUR.js";import{u as Y}from"./Bd6NytqX.js";import{u as W}from"./CxFJkEQW.js";import{u as P}from"./RNqAkGFi.js";import{a as ee,u as Ce}from"./B0s32vCm.js";import{u as we}from"./7jg-uhs3.js";import{u as A}from"./BBOJC0Fp.js";import{V as L}from"./CBMwLEAi.js";import{V as h,a as v}from"./CBD4vqXw.js";import{V as De}from"./oc_cjQCQ.js";import{V as Ie}from"./jEoM5WGA.js";import{V as G,a as Re,b as Te}from"./BKLBTNf2.js";import{V as M}from"./BuMHRPYM.js";import{I as $e}from"./DRGxzRnG.js";import"./DM74y-lG.js";import"./jgFPC-YH.js";import"./CCplKXSH.js";import"./D4kCc-2L.js";import"./C_E0yuJW.js";import"./RaWWsbWd.js";import"./C7GJWzQm.js";import"./BcbdIiL8.js";import"./BgTXVoAQ.js";import"./BNbKN7SF.js";import"./0QfyqDfL.js";import"./DyCxiiia.js";/* empty css        */import"./AhSsP66g.js";const Ue={class:"select-search"},Fe={class:"create-location"},Pe=U({__name:"SelectLocation",props:ue({multiple:{type:Boolean,default:!0},chips:{type:Boolean,default:!0},closableChips:{type:Boolean,default:!0},locations:{type:Array,default:()=>[]}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(b){const f=b,o=$(""),{locations:r}=I(ee()),{scheduleStoreRequest:d}=I(W()),S=we(m=>{ee().getLocations(m)},500);me(()=>{o.value.length>2&&S(o.value)}),D(()=>r.value??[]);const V=K(b,"modelValue");return(m,i)=>{const n=Z;return g(),k(N,{modelValue:V.value,"onUpdate:modelValue":[i[1]||(i[1]=c=>V.value=c),i[2]||(i[2]=c=>m.$emit("update:modelValue",c))],"max-width":"400px",items:f.locations,multiple:!0,chips:f.chips,"closable-chips":f.closableChips,"item-title":"name","item-value":"id","return-object":""},{"prepend-item":a(()=>[x("div",null,[x("div",Ue,[t(J,{"prepend-inner-icon":"mdi-magnify",variant:"plain",class:"search-input",modelValue:l(o),"onUpdate:modelValue":i[0]||(i[0]=c=>z(o)?o.value=c:null),placeholder:"Buscar ubicación"},null,8,["modelValue"])]),x("div",Fe,[t(n,{name:"futzo-icon:black-plus",size:"24"}),i[3]||(i[3]=x("span",{class:"create-location__text"},"Crear nueva ubicación",-1))])])]),_:1},8,["modelValue","items","chips","closable-chips"])}}});function Be(b){return b.toISOString().split("T")[0]}const He={class:"ml-2 text-caption text-medium-emphasis"},qe={class:"ml-2 text-caption text-medium-emphasis"},ze={class:"text-body-1"},Ee={key:0,class:"text-error text-caption"},Le={class:"text-body-1"},je={key:0,class:"text-red ml-4"},Oe=U({__name:"01-general",setup(b,{expose:f}){const[o]=te(),{setValues:r,fields:d,meta:S,validate:V}=A("calendar-general-step"),{tournament:m}=I(W()),{scheduleSettings:i,scheduleStoreRequest:n}=I(P()),c=s=>{if(!s)return"";typeof s=="object"&&(s=Be(s));const[e,_,C]=s==null?void 0:s.split("-");return new Date(Number(e),Number(_)-1,Number(C))},p=s=>{if(s){const e=s.map(_=>({id:_.id,name:_.name}));r({locations:e}),n.value.general.locations=e}};ae(async()=>{r({total_teams:i.value.teams,tournament_id:n.value.general.tournament_id,tournament_format_id:n.value.general.tournament_format_id,football_type_id:n.value.general.football_type_id,start_date:c(n.value.general.start_date),game_time:n.value.general.game_time,time_between_games:n.value.general.time_between_games,locations:n.value.general.locations})});const u=D(()=>S.value.valid);return f({isValid:u,validate:V}),(s,e)=>{const _=re,C=de,F=Z,j=ce("auto-animate");return g(),k(L,{class:"container"},{default:a(()=>[t(h,null,{default:a(()=>[t(v,{cols:"12",lg:"4",md:"4"},{default:a(()=>e[10]||(e[10]=[x("span",{class:"text-body-1"}," Nombre del torneo ",-1)])),_:1,__:[10]}),t(v,{cols:"12",lg:"8",md:"8"},{default:a(()=>[t(N,H({density:"compact","item-value":"id","item-title":"name",items:[l(m)],"return-object":"",disabled:"",variant:"outlined",modelValue:l(d).tournament_id.fieldValue,"onUpdate:modelValue":e[0]||(e[0]=y=>l(d).tournament_id.fieldValue=y)},l(d).tournament_id.fieldPropsValue),null,16,["items","modelValue"])]),_:1})]),_:1}),t(h,null,{default:a(()=>[t(v,{cols:"12",lg:"4",md:"4"},{default:a(()=>e[11]||(e[11]=[x("span",{class:"text-body-1"},"Formato del torneo ",-1)])),_:1,__:[11]}),t(v,{cols:"12",lg:"8",md:"8"},{default:a(()=>{var y,q;return[t(N,H({density:"compact","item-value":"id","item-title":"name",items:[l(i).format],"return-object":"",disabled:"",variant:"outlined",modelValue:l(d).tournament_format_id.fieldValue,"onUpdate:modelValue":e[1]||(e[1]=oe=>l(d).tournament_format_id.fieldValue=oe)},l(d).tournament_format_id.fieldPropsValue),null,16,["items","modelValue"]),x("p",He,w((q=(y=l(i))==null?void 0:y.format)==null?void 0:q.description),1)]}),_:1})]),_:1}),t(h,null,{default:a(()=>[t(v,{cols:"12",lg:"4",md:"4"},{default:a(()=>e[12]||(e[12]=[x("span",{class:"text-body-1"},"Estilo",-1)])),_:1,__:[12]}),t(v,{cols:"12",lg:"8",md:"8"},{default:a(()=>{var y;return[t(N,H({density:"compact","item-value":"id","item-title":"name",items:[l(i).footballType],"return-object":"",disabled:"",variant:"outlined",modelValue:l(d).football_type_id.fieldValue,"onUpdate:modelValue":e[2]||(e[2]=q=>l(d).football_type_id.fieldValue=q)},l(d).football_type_id.fieldPropsValue),null,16,["items","modelValue"]),x("p",qe,w((y=l(i))==null?void 0:y.footballType.description),1)]}),_:1})]),_:1}),t(h,null,{default:a(()=>[t(v,{cols:"12",lg:"4",md:"4"},{default:a(()=>e[13]||(e[13]=[x("span",{class:"text-body-1 d-block"},"Total de equipos registrados:",-1)])),_:1,__:[13]}),t(v,{cols:"12",lg:"8",md:"8"},{default:a(()=>[x("p",ze,[t(Q,{color:"primary",readonly:"",variant:"outlined"},{default:a(()=>[R(w(l(i).teams),1)]),_:1})])]),_:1})]),_:1}),t(h,null,{default:a(()=>[t(v,{cols:"12",lg:"4",md:"4"},{default:a(()=>e[14]||(e[14]=[x("span",{class:"text-body-1"}," Fecha de inicio del torneo* ",-1)])),_:1,__:[14]}),t(v,{cols:"12",lg:"8",md:"8",ref_key:"parent",ref:o},{default:a(()=>[t(C,null,{default:a(()=>[t(_,{onStart_date_updated:e[3]||(e[3]=y=>l(n).general.start_date=y),start_date:l(d).start_date.fieldValue,"onUpdate:start_date":e[4]||(e[4]=y=>l(d).start_date.fieldValue=y),multiCalendar:!1},null,8,["start_date"])]),_:1}),l(d).start_date.fieldPropsValue["error-messages"]?(g(),T("small",Ee,w(l(d).start_date.fieldPropsValue["error-messages"][0]),1)):B("",!0)]),_:1},512)]),_:1}),t(h,null,{default:a(()=>[t(v,{cols:"12",lg:"4",md:"4"},{default:a(()=>e[15]||(e[15]=[x("span",{class:"text-body-1"}," Duración del partido* ",-1)])),_:1,__:[15]}),t(v,{cols:"12",lg:"8",md:"8"},{default:a(()=>[t(J,H({type:"number",variant:"outlined",density:"compact",min:0,"onUpdate:modelValue":[e[5]||(e[5]=y=>l(n).general.game_time=y),e[6]||(e[6]=y=>l(d).game_time.fieldValue=y)],modelValue:l(d).game_time.fieldValue},l(d).game_time.fieldPropsValue),null,16,["modelValue"])]),_:1})]),_:1}),t(h,null,{default:a(()=>[t(v,{cols:"12",lg:"4",md:"4"},{default:a(()=>e[16]||(e[16]=[x("span",{class:"text-body-1"}," Tiempo entre partidos* ",-1)])),_:1,__:[16]}),t(v,{cols:"12",lg:"8",md:"8"},{default:a(()=>[t(J,H({type:"number",variant:"outlined",density:"compact","onUpdate:modelValue":[e[7]||(e[7]=y=>l(n).general.time_between_games=y),e[8]||(e[8]=y=>l(d).time_between_games.fieldValue=y)],modelValue:l(d).time_between_games.fieldValue},l(d).time_between_games.fieldPropsValue,{min:"0"}),null,16,["modelValue"])]),_:1})]),_:1}),t(h,null,{default:a(()=>[t(v,{cols:"12",lg:"4",md:"4"},{default:a(()=>[x("span",Le,[e[17]||(e[17]=R(" Ubicaciones* ")),t(De,{text:"Ubicación de los campos de juego",location:"bottom"},{activator:a(({props:y})=>[t(F,H(y,{name:"futzo-icon:help-circle"}),null,16)]),_:1})])]),_:1}),t(v,{cols:"12",lg:"8",md:"8"},{default:a(()=>[t(Pe,{locations:l(i).locations,modelValue:l(d).locations.fieldValue,"onUpdate:modelValue":[e[9]||(e[9]=y=>l(d).locations.fieldValue=y),p]},null,8,["locations","modelValue"]),pe((g(),T("div",null,[l(d).locations.fieldPropsValue["error-messages"]?(g(),T("small",je,w(l(d).locations.fieldPropsValue["error-messages"][0]),1)):B("",!0)])),[[j]])]),_:1})]),_:1})]),_:1})}}}),Ne={class:"w-100 d-flex py-1"},Me=U({__name:"Tiebreakers",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(b){const f=K(b,"modelValue"),o=D(()=>{var n;return(n=f.value)==null?void 0:n.slice().sort((c,p)=>c.priority-p.priority)});let r=null;const d=n=>{r=n},S=n=>{var p,u;if(r===null||r===n)return;const c=(p=f.value)==null?void 0:p.splice(r,1)[0];(u=f.value)==null||u.splice(n,0,c),r=n,m()},V=()=>{r=null},m=()=>{var n;(n=f.value)==null||n.forEach((c,p)=>{c.priority=p+1})},[i]=te();return(n,c)=>(g(),k(fe,{density:"compact",lines:"one",slim:"",ref_key:"parent",ref:i},{default:a(()=>[(g(!0),T(E,null,O(l(o),(p,u)=>(g(),k(_e,{class:"draggable-item futzo-rounded",draggable:!0,density:"compact",onDrop:V,onDragstart:s=>d(u),onDragover:ve(s=>S(u),["prevent"]),key:u},{default:a(()=>[t(be,{density:"compact"},{default:a(()=>[x("div",Ne,[x("span",{class:X(p.is_active?"":"text-disabled")},w(p.rule),3),t(Ie),t(G,{inset:"",density:"compact","false-icon":"mdi-lightbulb-off","true-icon":"mdi-lightbulb-on",modelValue:p.is_active,"onUpdate:modelValue":s=>p.is_active=s,"base-color":"white",color:"white",class:"futzo-rounded"},{thumb:a(({icon:s})=>[s?(g(),k(ge,{key:0,color:"primary",size:"14"},{default:a(()=>[R(w(s),1)]),_:2},1024)):B("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),_:2},1024),t(Ve,{class:X([p.is_active?"":"text-disabled","text-caption"]),tag:"small"},{default:a(()=>[R(" Prioridad: "+w(p.priority),1)]),_:2},1032,["class"])]),_:2},1032,["onDragstart","onDragover"]))),128))]),_:1},512))}}),Ae=U({__name:"02-regular-phase",setup(b,{expose:f}){var m,i,n,c;const{scheduleStoreRequest:o}=I(P()),{fields:r,meta:d,validate:S}=A("calendar-regular-step",{round_trip:(i=(m=o.value)==null?void 0:m.regular_phase)==null?void 0:i.round_trip,tiebreakers:(c=(n=o.value)==null?void 0:n.regular_phase)==null?void 0:c.tiebreakers}),V=D(()=>d.value.valid);return f({isValid:V,validate:S}),le(r.tiebreakers,p=>{p!=null&&p.fieldValue&&(o.value.regular_phase.tiebreakers=p.fieldValue)},{deep:!0}),(p,u)=>(g(),k(L,{class:"container"},{default:a(()=>[t(h,null,{default:a(()=>[t(v,{cols:"12",lg:"4",md:"4"},{default:a(()=>u[3]||(u[3]=[x("span",{class:"text-body-1"}," Ida y Vuelta? ",-1)])),_:1,__:[3]}),t(v,{cols:"12",lg:"8",md:"8"},{default:a(()=>[t(G,H({modelValue:l(r).round_trip.fieldValue,"onUpdate:modelValue":u[0]||(u[0]=s=>l(r).round_trip.fieldValue=s)},l(r).round_trip.fieldPropsValue,{"onUpdate:modelValue":u[1]||(u[1]=s=>l(o).regular_phase.round_trip=s)}),null,16,["modelValue"])]),_:1})]),_:1}),t(h,null,{default:a(()=>[t(v,{cols:"12",lg:"4",md:"4"},{default:a(()=>u[4]||(u[4]=[x("span",{class:"text-body-1 d-block"}," Reglas de desempate",-1),x("small",null,"Ordena en orden ascendente la prioridad de desempate",-1)])),_:1,__:[4]}),t(v,{cols:"12",lg:"8",md:"8"},{default:a(()=>[t(Me,{modelValue:l(r).tiebreakers.fieldValue,"onUpdate:modelValue":u[2]||(u[2]=s=>l(r).tiebreakers.fieldValue=s)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}))}}),Ge={key:0,class:"text-caption"},Je=U({__name:"03-elimination-phase",setup(b,{expose:f}){var u;const{scheduleSettings:o}=I(P()),r=s=>{var e,_;(e=o.value)==null||e.phases.map(C=>C.is_active=s.includes(C.id)),d.eliminationPhases.fieldValue=(_=o.value)==null?void 0:_.phases.filter(C=>C.is_active)},{fields:d,meta:S,validate:V}=A("calendar-elimination-step",{elimination_round_trip:o.value.elimination_round_trip,eliminationPhases:o.value.phases}),m=$((u=o.value)==null?void 0:u.phases.filter(s=>s.is_active).map(s=>s.id)),i=D(()=>{var s;return(s=o.value)==null?void 0:s.teams}),n=s=>s.name==="Fase de grupos"||s.name==="Tabla general"||i.value<16&&s.name==="Octavos de Final"||i.value<8&&s.name==="Cuartos de Final",c=D(()=>{const s=o.value.phases,e=y=>s.find(q=>q.name===y),_=e("Octavos de Final"),C=e("Cuartos de Final"),F=e("Semifinales"),j=e("Final");return i.value>16&&(_!=null&&_.is_active)?16:i.value>8&&(C!=null&&C.is_active)?8:i.value>4&&(F!=null&&F.is_active)?4:i.value>2&&(j!=null&&j.is_active)?2:1}),p=D(()=>S.value.valid);return f({isValid:p,validate:V}),(s,e)=>(g(),k(L,{class:"container"},{default:a(()=>[t(h,null,{default:a(()=>[t(v,{cols:"12",lg:"4",md:"4"},{default:a(()=>e[2]||(e[2]=[x("span",{class:"text-body-1 d-block"},"Avanzan a la siguiente ronda:",-1)])),_:1,__:[2]}),t(v,{cols:"12",lg:"8",md:"8"},{default:a(()=>[x("p",null,w(l(c)),1)]),_:1})]),_:1}),t(h,null,{default:a(()=>[t(v,{cols:"12",lg:"4",md:"4"},{default:a(()=>e[3]||(e[3]=[x("span",{class:"text-body-1"}," Ida y Vuelta? ",-1)])),_:1,__:[3]}),t(v,{cols:"12",lg:"8",md:"8"},{default:a(()=>[t(G,{modelValue:l(d).elimination_round_trip.fieldValue,"onUpdate:modelValue":e[0]||(e[0]=_=>l(d).elimination_round_trip.fieldValue=_)},null,8,["modelValue"])]),_:1})]),_:1}),t(h,null,{default:a(()=>[t(v,{cols:"12",lg:"4",md:"4"},{default:a(()=>e[4]||(e[4]=[x("span",{class:"text-body-1 d-block"},"Fases:",-1)])),_:1,__:[4]}),t(v,{cols:"12",lg:"8",md:"8"},{default:a(()=>[t(se,{multiple:"",column:"",filter:"",modelValue:l(m),"onUpdate:modelValue":[e[1]||(e[1]=_=>z(m)?m.value=_:null),r]},{default:a(()=>[(g(!0),T(E,null,O(l(o).phases,_=>(g(),k(Q,{key:_.id,disabled:n(_),value:_.id},{default:a(()=>[R(w(_.name),1)]),_:2},1032,["disabled","value"]))),128))]),_:1},8,["modelValue"]),l(o).format.name==="Liga y Eliminatoria"?(g(),T("small",Ge," *Fase de grupos es obligatoria ")):B("",!0)]),_:1})]),_:1})]),_:1}))}}),Ze=U({__name:"InputAvailabilityDate",props:{day:{type:Object,required:!0},label:{type:String,required:!0},id:{type:String,required:!0}},emits:["input-date-changed","day-disabled"],setup(b,{emit:f}){const o=b,r=$([]),d=D(()=>o.day.intervals.filter(m=>!m.disabled).map(m=>m.value)),S=D({get:()=>r.value.length>0&&r.value.length===d.value.length,set(m){m?r.value=[...d.value]:r.value=[]}});le(r,m=>{V("input-date-changed",{id:o.id,value:m})});const V=f;return(m,i)=>(g(),k(L,{class:"pa-0 pb-1"},{default:a(()=>[t(h,{"no-gutters":""},{default:a(()=>[t(v,{cols:"12",class:"pr-2 pt-2"},{default:a(()=>[t(ye,{class:"futzo-rounded"},{default:a(()=>[t(xe,null,{default:a(()=>[R(w(o.label),1)]),_:1}),t(Se,null,{default:a(()=>[R("Horas disponibles "+w(o.day.available_range),1)]),_:1}),t(ke,null,{default:a(()=>[t(G,{modelValue:l(S),"onUpdate:modelValue":i[0]||(i[0]=n=>z(S)?S.value=n:null),label:"Todo el día"},null,8,["modelValue"]),t(se,{column:"",multiple:"","selected-class":"text-primary",modelValue:l(r),"onUpdate:modelValue":i[1]||(i[1]=n=>z(r)?r.value=n:null)},{default:a(()=>[(g(!0),T(E,null,O(o.day.intervals,(n,c)=>(g(),k(Q,{key:c,filter:"",value:n.value,disabled:n.disabled,class:"ma-1",text:n.text},null,8,["value","disabled","text"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Ke=U({__name:"location-form-step",props:{field:{type:Object,required:!0},isLastStep:{type:Boolean,required:!0}},emits:["back","next","field-disabled"],setup(b,{emit:f}){const o=b,{scheduleStoreRequest:r}=I(P()),d=$({field_id:o.field.field_id,name:o.field.field_name,isCompleted:!1,availability:o.field.availability}),S=({id:n,value:c})=>{r.value.fields_phase.forEach(p=>{p.location_id===o.field.location_id&&p.field_id===o.field.field_id&&p.availability[n].intervals.forEach(u=>{u.selected=c.includes(u.value)})})},V=D(()=>{let n={};for(const c in o.field.availability)typeof o.field.availability[c]=="object"&&(n[c]=o.field.availability[c]);return n}),m=f,i=n=>{d.value.availability[n].enabled=!d.value.availability[n].enabled};return(n,c)=>{const p=Z;return g(),T(E,null,[(g(!0),T(E,null,O(l(V),(u,s)=>(g(),k(Ze,{disabled:b.field.disabled,day:o.field.availability[s],key:s,"data-value":s,id:s,label:u.label,onInputDateChanged:S,onDayDisabled:i},null,8,["disabled","day","data-value","id","label"]))),128)),t(h,null,{default:a(()=>[t(v,null,{default:a(()=>[t(M,{color:"secondary",variant:"outlined",class:"vertical-stepper-button back",onClick:c[0]||(c[0]=u=>m("back")),disabled:b.isLastStep},{default:a(()=>c[2]||(c[2]=[R("Anterior ")])),_:1,__:[2]},8,["disabled"]),t(M,{color:"primary",variant:"outlined",class:"vertical-stepper-button next",onClick:c[1]||(c[1]=u=>m("next",l(d)))},{append:a(()=>[t(p,{name:"mdi-arrow-right"})]),default:a(()=>[c[3]||(c[3]=R("Marcar como completado "))]),_:1,__:[3]})]),_:1})]),_:1})],64)}}}),Qe=U({__name:"04-fields-phase",setup(b,{expose:f}){const{tournamentId:o}=I(W()),{scheduleStoreRequest:r}=I(P()),{meta:d,validate:S}=A("calendar-location-step",{tournament_id:o.value,fields:r.value.fields_phase}),V=D(()=>d.value.valid);f({isValid:V,validate:S});const m=$(),i=$([]),n=u=>{r.value.fields_phase.map(s=>{s.field_id===u.field_id&&(s.availability.isCompleted=!0)}),m.value<i.value.length&&(m.value+=1)},c=()=>{m.value>1&&(m.value-=1)};ae(async()=>{var e;const u=r.value.general.locations.map(_=>_.id),s=he();i.value=await s(`/api/v1/admin/locations/fields?location_ids=${u.join(",")}&tournament_id=${o.value}`),r.value.fields_phase=i.value,m.value=(e=i.value[0])==null?void 0:e.step});const p=u=>{i.value.map(e=>{if(e.field_id===u.field_id){e.disabled=!e.disabled;for(let _ in e.availability)e.availability[_].enabled=e.availability[_].enabled===!0?!1:e.availability[_].enabled}});const s=i.value.filter(e=>e.field_id===u.field_id)[0];n({availability:s.availability,field_id:s.field_id,name:s.field_name})};return(u,s)=>(g(),k(L,null,{default:a(()=>[t(h,null,{default:a(()=>[t(v,null,{default:a(()=>[t(Re,{class:"pa-0 ma-0",flat:"",modelValue:l(m),"onUpdate:modelValue":s[0]||(s[0]=e=>z(m)?m.value=e:null),"item-value":"step","item-title":"location_name","item-subtitle":"field_name"},{default:a(()=>[(g(!0),T(E,null,O(l(i),(e,_)=>(g(),k(Te,{key:_+1,value:e.step,title:e.location_name,subtitle:e.field_name,"complete-icon":"mdi-check-circle","edit-icon":"mdi-check-circle","expand-icon":"mdi-chevron-down"},{actions:a(()=>s[1]||(s[1]=[x("small",{class:"text-caption"},"* Marcar como completado para avanzar/finalizar",-1)])),default:a(()=>[t(Ke,{field:e,isLastStep:l(i).length===l(m)-1,onNext:n,onBack:c,onFieldDisabled:p},null,8,["field","isLastStep"])]),_:2},1032,["value","title","subtitle"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}}),We=U({__name:"index",props:{stepRef:{},stepRefModifiers:{}},emits:["update:stepRef"],setup(b,{expose:f}){const{calendarSteps:o}=I(P()),r=K(b,"stepRef");return f({hasValidForm:()=>{var V;return(V=r.value)==null?void 0:V.isValid},validate:async()=>await r.value.validate()}),(V,m)=>{const i=ie;return g(),k(L,{class:"pa-0"},{default:a(()=>[t(h,null,{default:a(()=>[t(v,null,{default:a(()=>[t($e,{"form-steps":l(o)},null,8,["form-steps"])]),_:1})]),_:1}),t(h,null,{default:a(()=>[t(v,null,{default:a(()=>[t(i,{group:"",offset:{enter:["-100%",0],leave:["100%",0]}},{default:a(()=>[l(o).current==="general"?(g(),k(Oe,{ref_key:"stepRef",ref:r,key:l(o).current})):B("",!0),l(o).current==="regular"?(g(),k(Ae,{ref_key:"stepRef",ref:r,key:l(o).current})):B("",!0),l(o).current==="elimination"?(g(),k(Je,{ref_key:"stepRef",ref:r,key:l(o).current})):B("",!0),l(o).current==="fields"?(g(),k(Qe,{ref_key:"stepRef",ref:r,key:l(o).current})):B("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Xe=(b,f)=>{const o=$({}),r=$({validate:Function,handleSubmit:Function}),d=b.value.steps[b.value.steps.length-1],S=b.value.steps[0],V=b.value.steps.map(p=>p.step).join(",").split(","),m=D(()=>b.value.current===S.step?"Cancelar":"Regresar"),i=D(()=>b.value.current===d.step?"Crear":"Siguiente");return{settings:o,secondaryTextBtn:m,primaryTextBtn:i,stepRef:r,backHandler:()=>{if(b.value.current===S.step){f.value=!1;return}const p=V.indexOf(b.value.current);b.value.steps.forEach((u,s)=>{p<s+1&&(u.completed=!1)}),b.value.current=V[p-1]},nextHandler:async()=>{const p=await r.value.validate(),s=await r.value.handleSubmit(e=>e)();console.log(s),p.valid}}},Ut=U({__name:"index",setup(b){const{calendarSteps:f,scheduleDialog:o,scheduleStoreRequest:r,schedulePagination:d}=I(P()),{secondaryTextBtn:S,primaryTextBtn:V,backHandler:m}=Xe(f,o),i=$(),n=$(!1),c=()=>{f.value.steps.forEach(e=>e.completed=!1),f.value.current="general"},p=async()=>{let e=!i.value.hasValidForm();f.value.current==="general"?await i.value.validate():f.value.current==="regular"?await i.value.validate():f.value.current==="elimination"?await i.value.validate():f.value.current==="fields"&&await i.value.validate(),e||s()},u=D(()=>f.value.current!=="fields"?!1:!r.value.fields_phase.every(e=>e.availability.isCompleted)),s=()=>{const e=["general","regular","elimination","fields"],_=e.indexOf(f.value.current);f.value.steps[_].completed||(f.value.steps[_].completed=!0),f.value.current!=="fields"?f.value.current=e[_+1]:(n.value=!0,P().generateSchedule().then(()=>{P().getTournamentSchedules().finally(()=>{n.value=!1,o.value=!1,d.value.currentPage=1,Y().toast("success","Calendario creado","El calendario se ha creado correctamente")})}).finally(()=>n.value=!1).catch(C=>{n.value=!1;const{message:F}=Ce(C);Y().toast("error","Error al crear el calendario",F||"Ha ocurrido un error al crear el calendario")}))};return(e,_)=>{const C=ne;return g(),k(C,{title:"Crear un calendario",subtitle:"Completa los detalles del calendario.",actions:{primary:l(V),secondary:l(S)},loading:!1,modelValue:l(o),"onUpdate:modelValue":_[0]||(_[0]=F=>z(o)?o.value=F:null),onLeaving:c},{"v-card-text":a(()=>[t(We,{ref_key:"stepContainerRef",ref:i},null,512)]),actions:a(()=>[t(M,{width:"50%","min-height":"44",variant:"outlined",color:"secondary",density:"comfortable",size:"large",onClick:l(m)},{default:a(()=>[R(w(l(S)),1)]),_:1},8,["onClick"]),t(M,{width:"50%","min-height":"44",variant:"elevated",color:"primary",density:"comfortable",size:"large",loading:l(n),disabled:l(u)||l(n),onClick:p},{default:a(()=>[R(w(l(V)),1)]),_:1},8,["loading","disabled"])]),_:1},8,["actions","modelValue"])}}});export{Ut as default};
